openapi: 3.0.0
info:
  title: WhatsApp API Server
  description: API for managing WhatsApp connections, sending messages, and more.
  version: 1.0.0

servers:
  - url: http://localhost:3000/api
    description: Local development server

components:
  securitySchemes:
    ApiKeyAuth:
      type: apiKey
      in: header
      name: X-API-Key

  schemas:
    Error:
      type: object
      properties:
        status:
          type: boolean
          example: false
        message:
          type: string
          example: Error message
        error:
          type: string
          example: Detailed error description

    Status:
      type: object
      properties:
        status:
          type: boolean
          example: true

    Session:
      type: object
      properties:
        id:
          type: string
          example: user1
        status:
          type: string
          enum: [connecting, open, closed]
          example: open
        qr:
          type: string
          nullable: true
          example: "data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAA..."

paths:
  # SESSION MANAGEMENT
  /session:
    post:
      summary: Create a new WhatsApp session
      tags:
        - Session
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                sessionId:
                  type: string
                  example: user1
              required:
                - sessionId
      responses:
        200:
          description: Session created or restored successfully
          content:
            application/json:
              schema:
                allOf:
                  - $ref: "#/components/schemas/Status"
                  - type: object
                    properties:
                      message:
                        type: string
                        example: Session created or restored successfully
                      session:
                        $ref: "#/components/schemas/Session"
        400:
          description: Bad request
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"

  # AUTO REPLY
  /auto-reply/{sessionId}:
    get:
      summary: Get auto-reply configuration for a session
      tags:
        - Auto Reply
      security:
        - ApiKeyAuth: []
      parameters:
        - name: sessionId
          in: path
          required: true
          schema:
            type: string
      responses:
        200:
          description: Auto-reply configuration
          content:
            application/json:
              schema:
                allOf:
                  - $ref: "#/components/schemas/Status"
                  - type: object
                    properties:
                      config:
                        type: object
                        properties:
                          enabled:
                            type: boolean
                            example: true
                          rules:
                            type: array
                            items:
                              type: object
                              properties:
                                id:
                                  type: string
                                  example: "rule_1234567890"
                                type:
                                  type: string
                                  enum: [text, pattern, media]
                                  example: "text"
                                trigger:
                                  type: string
                                  example: "hello"
                                response:
                                  type: object
                                  properties:
                                    type:
                                      type: string
                                      enum: [text, image, template]
                                      example: "text"
                                    content:
                                      oneOf:
                                        - type: string
                                        - type: object
                                      example: "Hi there! How can I help you today?"
                                enabled:
                                  type: boolean
                                  example: true
                                matchCase:
                                  type: boolean
                                  example: false
                                probability:
                                  type: number
                                  minimum: 0
                                  maximum: 1
                                  example: 1
                          defaultResponse:
                            type: object
                            nullable: true
                            properties:
                              type:
                                type: string
                                enum: [text, image, template]
                                example: "text"
                              content:
                                oneOf:
                                  - type: string
                                  - type: object
                                example: "Thank you for your message. We'll get back to you soon."
                          respondToGroups:
                            type: boolean
                            example: false
                          delay:
                            type: integer
                            example: 1000
        404:
          description: Session not found
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"

  /auto-reply/config:
    post:
      summary: Update auto-reply configuration
      tags:
        - Auto Reply
      security:
        - ApiKeyAuth: []
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required:
                - sessionId
                - config
              properties:
                sessionId:
                  type: string
                  example: user1
                config:
                  type: object
                  properties:
                    enabled:
                      type: boolean
                      example: true
                    defaultResponse:
                      type: object
                      nullable: true
                      properties:
                        type:
                          type: string
                          enum: [text, image, template]
                          example: "text"
                        content:
                          oneOf:
                            - type: string
                            - type: object
                          example: "Thank you for your message. We'll get back to you soon."
                    respondToGroups:
                      type: boolean
                      example: false
                    delay:
                      type: integer
                      example: 1000
      responses:
        200:
          description: Auto-reply configuration updated
          content:
            application/json:
              schema:
                allOf:
                  - $ref: "#/components/schemas/Status"
                  - type: object
                    properties:
                      message:
                        type: string
                        example: Auto-reply configuration updated successfully
                      config:
                        type: object
        400:
          description: Bad request
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"

  /auto-reply/rule:
    post:
      summary: Add a new auto-reply rule
      tags:
        - Auto Reply
      security:
        - ApiKeyAuth: []
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required:
                - sessionId
                - rule
              properties:
                sessionId:
                  type: string
                  example: user1
                rule:
                  type: object
                  required:
                    - type
                    - trigger
                    - response
                  properties:
                    type:
                      type: string
                      enum: [text, pattern, media]
                      example: "text"
                    trigger:
                      type: string
                      example: "hello"
                    response:
                      type: object
                      properties:
                        type:
                          type: string
                          enum: [text, image, template]
                          example: "text"
                        content:
                          oneOf:
                            - type: string
                            - type: object
                          example: "Hi there! How can I help you today?"
                    enabled:
                      type: boolean
                      default: true
                      example: true
                    matchCase:
                      type: boolean
                      default: false
                      example: false
                    probability:
                      type: number
                      minimum: 0
                      maximum: 1
                      default: 1
                      example: 1
      responses:
        200:
          description: Auto-reply rule added
          content:
            application/json:
              schema:
                allOf:
                  - $ref: "#/components/schemas/Status"
                  - type: object
                    properties:
                      message:
                        type: string
                        example: Auto-reply rule added successfully
                      rule:
                        type: object
        400:
          description: Bad request
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"

    put:
      summary: Update an existing auto-reply rule
      tags:
        - Auto Reply
      security:
        - ApiKeyAuth: []
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required:
                - sessionId
                - ruleId
                - updates
              properties:
                sessionId:
                  type: string
                  example: user1
                ruleId:
                  type: string
                  example: "rule_1234567890"
                updates:
                  type: object
                  properties:
                    enabled:
                      type: boolean
                      example: false
                    response:
                      type: object
                      properties:
                        type:
                          type: string
                          enum: [text, image, template]
                          example: "text"
                        content:
                          oneOf:
                            - type: string
                            - type: object
                          example: "Updated response message"
      responses:
        200:
          description: Auto-reply rule updated
          content:
            application/json:
              schema:
                allOf:
                  - $ref: "#/components/schemas/Status"
                  - type: object
                    properties:
                      message:
                        type: string
                        example: Auto-reply rule updated successfully
                      rule:
                        type: object
        400:
          description: Bad request
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"

  /auto-reply/{sessionId}/{ruleId}:
    delete:
      summary: Delete an auto-reply rule
      tags:
        - Auto Reply
      security:
        - ApiKeyAuth: []
      parameters:
        - name: sessionId
          in: path
          required: true
          schema:
            type: string
        - name: ruleId
          in: path
          required: true
          schema:
            type: string
      responses:
        200:
          description: Auto-reply rule deleted
          content:
            application/json:
              schema:
                allOf:
                  - $ref: "#/components/schemas/Status"
                  - type: object
                    properties:
                      message:
                        type: string
                        example: Auto-reply rule deleted successfully
        404:
          description: Rule not found
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"

  # BULK MESSAGING
  /bulk-message/send:
    post:
      summary: Send a bulk message to multiple recipients
      tags:
        - Bulk Messaging
      security:
        - ApiKeyAuth: []
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required:
                - sessionId
                - recipients
                - message
              properties:
                sessionId:
                  type: string
                  example: user1
                recipients:
                  type: array
                  items:
                    type: string
                  example: ["628123456789", "628987654321", "628123987456"]
                message:
                  type: object
                  required:
                    - type
                    - content
                  properties:
                    type:
                      type: string
                      enum: [text, template, image, document]
                      example: "text"
                    content:
                      oneOf:
                        - type: string
                        - type: object
                      example: "Hello! This is a bulk message sent to multiple recipients."
                campaignName:
                  type: string
                  example: "promotion_may2025"
                delay:
                  type: integer
                  default: 3000
                  example: 3000
      responses:
        200:
          description: Bulk message campaign started
          content:
            application/json:
              schema:
                allOf:
                  - $ref: "#/components/schemas/Status"
                  - type: object
                    properties:
                      message:
                        type: string
                        example: Bulk message campaign started
                      campaignId:
                        type: string
                        example: "promotion_may2025_1680123456789"
                      totalRecipients:
                        type: integer
                        example: 3
        400:
          description: Bad request
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"

  /bulk-message/send-personalized:
    post:
      summary: Send a personalized bulk message using templates with variables
      tags:
        - Bulk Messaging
      security:
        - ApiKeyAuth: []
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required:
                - sessionId
                - recipients
                - messageTemplate
              properties:
                sessionId:
                  type: string
                  example: user1
                recipients:
                  type: array
                  items:
                    type: object
                    required:
                      - number
                    properties:
                      number:
                        type: string
                        example: "628123456789"
                      variables:
                        type: object
                        example:
                          {
                            "name": "John",
                            "product": "Premium Plan",
                            "discount": "30%",
                          }
                  example:
                    [
                      {
                        "number": "628123456789",
                        "variables":
                          {
                            "name": "John",
                            "product": "Premium Plan",
                            "discount": "30%",
                          },
                      },
                      {
                        "number": "628987654321",
                        "variables":
                          {
                            "name": "Sarah",
                            "product": "Business Plan",
                            "discount": "25%",
                          },
                      },
                    ]
                messageTemplate:
                  type: object
                  required:
                    - type
                    - content
                  properties:
                    type:
                      type: string
                      enum: [text, template]
                      example: "text"
                    content:
                      oneOf:
                        - type: string
                        - type: object
                      example: "Hello {{name}}! We're offering you a special {{discount}} discount on your {{product}} subscription. Reply if you're interested!"
                campaignName:
                  type: string
                  example: "personalized_offers"
                delay:
                  type: integer
                  default: 3000
                  example: 3000
      responses:
        200:
          description: Personalized bulk message campaign started
          content:
            application/json:
              schema:
                allOf:
                  - $ref: "#/components/schemas/Status"
                  - type: object
                    properties:
                      message:
                        type: string
                        example: Personalized bulk message campaign started
                      campaignId:
                        type: string
                        example: "personalized_offers_1680123456789"
                      totalRecipients:
                        type: integer
                        example: 2
        400:
          description: Bad request
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"

  /bulk-message/upload-csv:
    post:
      summary: Upload a CSV file with recipients for bulk messaging
      tags:
        - Bulk Messaging
      security:
        - ApiKeyAuth: []
      requestBody:
        required: true
        content:
          multipart/form-data:
            schema:
              type: object
              required:
                - file
              properties:
                file:
                  type: string
                  format: binary
                  description: CSV file with recipients
      responses:
        200:
          description: CSV processed successfully
          content:
            application/json:
              schema:
                allOf:
                  - $ref: "#/components/schemas/Status"
                  - type: object
                    properties:
                      message:
                        type: string
                        example: CSV processed successfully
                      recipients:
                        type: array
                        items:
                          type: object
                          properties:
                            number:
                              type: string
                              example: "628123456789"
                            variables:
                              type: object
                              example:
                                {
                                  "name": "John",
                                  "product": "Premium Plan",
                                  "discount": "30%",
                                }
                      count:
                        type: integer
                        example: 3
        400:
          description: Bad request
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"

  /bulk-message/campaign/{campaignId}:
    get:
      summary: Get status of a specific campaign
      tags:
        - Bulk Messaging
      security:
        - ApiKeyAuth: []
      parameters:
        - name: campaignId
          in: path
          required: true
          schema:
            type: string
      responses:
        200:
          description: Campaign status
          content:
            application/json:
              schema:
                allOf:
                  - $ref: "#/components/schemas/Status"
                  - type: object
                    properties:
                      campaign:
                        type: object
                        properties:
                          id:
                            type: string
                            example: "promotion_may2025_1680123456789"
                          sessionId:
                            type: string
                            example: "user1"
                          messageType:
                            type: string
                            example: "text"
                          totalRecipients:
                            type: integer
                            example: 3
                          processedCount:
                            type: integer
                            example: 2
                          successCount:
                            type: integer
                            example: 2
                          failedCount:
                            type: integer
                            example: 0
                          startTime:
                            type: integer
                            example: 1680123456789
                          endTime:
                            type: integer
                            nullable: true
                            example: null
                          status:
                            type: string
                            enum: [processing, completed, failed, cancelled]
                            example: "processing"
                          progress:
                            type: integer
                            example: 67
        404:
          description: Campaign not found
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"

  /bulk-message/campaigns/{sessionId}:
    get:
      summary: List all campaigns for a session
      tags:
        - Bulk Messaging
      security:
        - ApiKeyAuth: []
      parameters:
        - name: sessionId
          in: path
          required: true
          schema:
            type: string
      responses:
        200:
          description: List of campaigns
          content:
            application/json:
              schema:
                allOf:
                  - $ref: "#/components/schemas/Status"
                  - type: object
                    properties:
                      count:
                        type: integer
                        example: 2
                      campaigns:
                        type: array
                        items:
                          type: object
                          properties:
                            id:
                              type: string
                              example: "promotion_may2025_1680123456789"
                            messageType:
                              type: string
                              example: "text"
                            totalRecipients:
                              type: integer
                              example: 3
                            successCount:
                              type: integer
                              example: 3
                            failedCount:
                              type: integer
                              example: 0
                            startTime:
                              type: integer
                              example: 1680123456789
                            endTime:
                              type: integer
                              nullable: true
                              example: 1680123499999
                            status:
                              type: string
                              enum: [processing, completed, failed, cancelled]
                              example: "completed"
        404:
          description: Session not found
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"

  /bulk-message/cancel:
    post:
      summary: Cancel an ongoing campaign
      tags:
        - Bulk Messaging
      security:
        - ApiKeyAuth: []
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required:
                - campaignId
              properties:
                campaignId:
                  type: string
                  example: "campaign_1234567890"
      responses:
        200:
          description: Campaign cancelled successfully
          content:
            application/json:
              schema:
                allOf:
                  - $ref: "#/components/schemas/Status"
                  - type: object
                    properties:
                      message:
                        type: string
                        example: Campaign cancelled successfully
                      campaignId:
                        type: string
                        example: "campaign_1234567890"
        400:
          description: Bad request or campaign not found
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"

  /session/{sessionId}:
    get:
      summary: Get status of a specific session
      tags:
        - Session
      parameters:
        - name: sessionId
          in: path
          required: true
          schema:
            type: string
      responses:
        200:
          description: Session information
          content:
            application/json:
              schema:
                allOf:
                  - $ref: "#/components/schemas/Status"
                  - type: object
                    properties:
                      session:
                        $ref: "#/components/schemas/Session"
        404:
          description: Session not found
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"

    delete:
      summary: Delete a session and disconnect
      tags:
        - Session
      parameters:
        - name: sessionId
          in: path
          required: true
          schema:
            type: string
      responses:
        200:
          description: Session deleted successfully
          content:
            application/json:
              schema:
                allOf:
                  - $ref: "#/components/schemas/Status"
                  - type: object
                    properties:
                      message:
                        type: string
                        example: Session deleted successfully
                      sessionId:
                        type: string
                        example: user1
        404:
          description: Session not found
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"

  /session/qr/{sessionId}:
    get:
      summary: Get QR code for a session
      tags:
        - Session
      parameters:
        - name: sessionId
          in: path
          required: true
          schema:
            type: string
      responses:
        200:
          description: QR code or connection status
          content:
            application/json:
              schema:
                allOf:
                  - $ref: "#/components/schemas/Status"
                  - type: object
                    properties:
                      qr:
                        type: string
                        nullable: true
                        example: "data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAA..."
                      connected:
                        type: boolean
                        example: false
        404:
          description: Session not found
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"

  /session/list/all:
    get:
      summary: List all active sessions
      tags:
        - Session
      responses:
        200:
          description: List of active sessions
          content:
            application/json:
              schema:
                allOf:
                  - $ref: "#/components/schemas/Status"
                  - type: object
                    properties:
                      count:
                        type: integer
                        example: 2
                      sessions:
                        type: array
                        items:
                          type: object
                          properties:
                            id:
                              type: string
                              example: user1
                            status:
                              type: string
                              example: open

  # STATUS ENDPOINTS
  /status/{sessionId}:
    get:
      summary: Get status of a specific session
      tags:
        - Status
      parameters:
        - name: sessionId
          in: path
          required: true
          schema:
            type: string
      responses:
        200:
          description: Session status
          content:
            application/json:
              schema:
                allOf:
                  - $ref: "#/components/schemas/Status"
                  - type: object
                    properties:
                      session:
                        type: object
                        properties:
                          id:
                            type: string
                            example: user1
                          status:
                            type: string
                            example: open
                          isConnected:
                            type: boolean
                            example: true
                          hasQueuedMessages:
                            type: boolean
                            example: false
                      queue:
                        type: object
                        properties:
                          itemsInQueue:
                            type: integer
                            example: 0
                          processing:
                            type: boolean
                            example: false
                          lastProcessed:
                            type: integer
                            nullable: true
                            example: 1680123456789
                          stats:
                            type: object
                            properties:
                              total:
                                type: integer
                                example: 10
                              success:
                                type: integer
                                example: 8
                              failed:
                                type: integer
                                example: 2
        404:
          description: Session not found
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"

  /status:
    get:
      summary: Get status of all sessions
      tags:
        - Status
      responses:
        200:
          description: All sessions status
          content:
            application/json:
              schema:
                allOf:
                  - $ref: "#/components/schemas/Status"
                  - type: object
                    properties:
                      count:
                        type: integer
                        example: 2
                      sessions:
                        type: array
                        items:
                          type: object
                          properties:
                            id:
                              type: string
                              example: user1
                            status:
                              type: string
                              example: open
                            isConnected:
                              type: boolean
                              example: true

  /status/server/health:
    get:
      summary: Check server health status
      tags:
        - Status
      responses:
        200:
          description: Server health status
          content:
            application/json:
              schema:
                allOf:
                  - $ref: "#/components/schemas/Status"
                  - type: object
                    properties:
                      uptime:
                        type: number
                        example: 3600
                      timestamp:
                        type: integer
                        example: 1680123456789
                      activeSessions:
                        type: integer
                        example: 2
                      memory:
                        type: object
                        properties:
                          rss:
                            type: string
                            example: "128.5 MB"
                          heapTotal:
                            type: string
                            example: "64.2 MB"
                          heapUsed:
                            type: string
                            example: "48.7 MB"
                      version:
                        type: string
                        example: "1.0.0"

  # MESSAGING ENDPOINTS
  /message/text:
    post:
      summary: Send a text message
      tags:
        - Messages
      security:
        - ApiKeyAuth: []
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required:
                - sessionId
                - to
                - text
              properties:
                sessionId:
                  type: string
                  example: user1
                to:
                  type: string
                  example: "628123456789"
                text:
                  type: string
                  example: "Hello, this is a test message"
                quotedMessageId:
                  type: string
                  example: "3EB0195D37F6"
                useQueue:
                  type: boolean
                  default: true
                  example: true
                queueOnly:
                  type: boolean
                  default: false
                  example: false
                delay:
                  type: integer
                  default: 1000
                  example: 1000
                retry:
                  type: integer
                  default: 3
                  example: 3
      responses:
        200:
          description: Message sent successfully
          content:
            application/json:
              schema:
                allOf:
                  - $ref: "#/components/schemas/Status"
                  - type: object
                    properties:
                      message:
                        type: string
                        example: Message sent successfully
                      messageInfo:
                        type: object
                      recipient:
                        type: string
                        example: "628123456789@s.whatsapp.net"
                      content:
                        type: string
                        example: "Hello, this is a test message"
        400:
          description: Bad request
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
        404:
          description: Session not found
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"

  /message/template:
    post:
      summary: Send a template message
      tags:
        - Messages
      security:
        - ApiKeyAuth: []
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required:
                - sessionId
                - to
                - template
              properties:
                sessionId:
                  type: string
                  example: user1
                to:
                  type: string
                  example: "628123456789"
                template:
                  type: object
                  properties:
                    header:
                      type: string
                      example: "Company Newsletter"
                    body:
                      type: string
                      example: "Hello, this is our monthly newsletter.\n\nCheck out our latest products!"
                    footer:
                      type: string
                      example: "Sent by WhatsApp API"
                useQueue:
                  type: boolean
                  default: true
                queueOnly:
                  type: boolean
                  default: false
                delay:
                  type: integer
                  default: 1000
                retry:
                  type: integer
                  default: 3
      responses:
        200:
          description: Template message sent successfully
          content:
            application/json:
              schema:
                allOf:
                  - $ref: "#/components/schemas/Status"
                  - type: object
                    properties:
                      message:
                        type: string
                        example: Message sent successfully
                      messageInfo:
                        type: object
                      recipient:
                        type: string
                        example: "628123456789@s.whatsapp.net"
        400:
          description: Bad request
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"

  /message/image:
    post:
      summary: Send an image message
      tags:
        - Messages
      security:
        - ApiKeyAuth: []
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required:
                - sessionId
                - to
                - image
              properties:
                sessionId:
                  type: string
                  example: user1
                to:
                  type: string
                  example: "628123456789"
                image:
                  type: string
                  description: URL, base64 string, or file path
                  example: "https://example.com/image.jpg"
                caption:
                  type: string
                  example: "Check out this image!"
                quotedMessageId:
                  type: string
                useQueue:
                  type: boolean
                  default: true
                queueOnly:
                  type: boolean
                  default: false
                delay:
                  type: integer
                  default: 1000
                retry:
                  type: integer
                  default: 3
      responses:
        200:
          description: Image message sent successfully
          content:
            application/json:
              schema:
                allOf:
                  - $ref: "#/components/schemas/Status"
                  - type: object
                    properties:
                      message:
                        type: string
                        example: Image sent successfully
                      messageInfo:
                        type: object
                      recipient:
                        type: string
                        example: "628123456789@s.whatsapp.net"
                      caption:
                        type: string
                        example: "Check out this image!"
        400:
          description: Bad request
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"

  /message/document:
    post:
      summary: Send a document message
      tags:
        - Messages
      security:
        - ApiKeyAuth: []
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required:
                - sessionId
                - to
                - document
                - filename
              properties:
                sessionId:
                  type: string
                  example: user1
                to:
                  type: string
                  example: "628123456789"
                document:
                  type: string
                  description: URL, base64 string, or file path
                  example: "https://example.com/document.pdf"
                filename:
                  type: string
                  example: "important_document.pdf"
                caption:
                  type: string
                  example: "Please review this document"
                quotedMessageId:
                  type: string
                useQueue:
                  type: boolean
                  default: true
                queueOnly:
                  type: boolean
                  default: false
                delay:
                  type: integer
                  default: 1000
                retry:
                  type: integer
                  default: 3
      responses:
        200:
          description: Document message sent successfully
          content:
            application/json:
              schema:
                allOf:
                  - $ref: "#/components/schemas/Status"
                  - type: object
                    properties:
                      message:
                        type: string
                        example: Document sent successfully
                      messageInfo:
                        type: object
                      recipient:
                        type: string
                        example: "628123456789@s.whatsapp.net"
                      filename:
                        type: string
                        example: "important_document.pdf"
                      caption:
                        type: string
                        example: "Please review this document"
        400:
          description: Bad request
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"

  /message/location:
    post:
      summary: Send a location message
      tags:
        - Messages
      security:
        - ApiKeyAuth: []
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required:
                - sessionId
                - to
                - latitude
                - longitude
              properties:
                sessionId:
                  type: string
                  example: user1
                to:
                  type: string
                  example: "628123456789"
                latitude:
                  type: number
                  example: -7.3297
                longitude:
                  type: number
                  example: 112.7892
                name:
                  type: string
                  example: "Sidoarjo City Square"
                address:
                  type: string
                  example: "Sidoarjo, East Java, Indonesia"
                quotedMessageId:
                  type: string
                useQueue:
                  type: boolean
                  default: true
                queueOnly:
                  type: boolean
                  default: false
                delay:
                  type: integer
                  default: 1000
                retry:
                  type: integer
                  default: 3
      responses:
        200:
          description: Location message sent successfully
          content:
            application/json:
              schema:
                allOf:
                  - $ref: "#/components/schemas/Status"
                  - type: object
                    properties:
                      message:
                        type: string
                        example: Location sent successfully
                      messageInfo:
                        type: object
                      recipient:
                        type: string
                        example: "628123456789@s.whatsapp.net"
                      coordinates:
                        type: object
                        properties:
                          latitude:
                            type: number
                            example: -7.3297
                          longitude:
                            type: number
                            example: 112.7892
                      name:
                        type: string
                        example: "Sidoarjo City Square"
                      address:
                        type: string
                        example: "Sidoarjo, East Java, Indonesia"
        400:
          description: Bad request
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"

  /message/queue/{sessionId}:
    get:
      summary: Get message queue status
      tags:
        - Messages
      security:
        - ApiKeyAuth: []
      parameters:
        - name: sessionId
          in: path
          required: true
          schema:
            type: string
      responses:
        200:
          description: Queue status
          content:
            application/json:
              schema:
                allOf:
                  - $ref: "#/components/schemas/Status"
                  - type: object
                    properties:
                      queue:
                        type: object
                        properties:
                          itemsInQueue:
                            type: integer
                            example: 5
                          processing:
                            type: boolean
                            example: true
                          lastProcessed:
                            type: integer
                            nullable: true
                            example: 1680123456789
                          stats:
                            type: object
                            properties:
                              total:
                                type: integer
                                example: 10
                              success:
                                type: integer
                                example: 8
                              failed:
                                type: integer
                                example: 2
        400:
          description: Bad request
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"

    delete:
      summary: Clear message queue
      tags:
        - Messages
      security:
        - ApiKeyAuth: []
      parameters:
        - name: sessionId
          in: path
          required: true
          schema:
            type: string
      responses:
        200:
          description: Queue cleared
          content:
            application/json:
              schema:
                allOf:
                  - $ref: "#/components/schemas/Status"
                  - type: object
                    properties:
                      message:
                        type: string
                        example: Queue cleared
                      removedCount:
                        type: integer
                        example: 5
                      queueId:
                        type: string
                        example: user1
        400:
          description: Bad request
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"

  /message/validate:
    post:
      summary: Validate a phone number
      tags:
        - Messages
      security:
        - ApiKeyAuth: []
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required:
                - sessionId
                - phoneNumber
              properties:
                sessionId:
                  type: string
                  example: user1
                phoneNumber:
                  type: string
                  example: "628123456789"
      responses:
        200:
          description: Validation result
          content:
            application/json:
              schema:
                allOf:
                  - $ref: "#/components/schemas/Status"
                  - type: object
                    properties:
                      exists:
                        type: boolean
                        example: true
                      jid:
                        type: string
                        example: "628123456789@s.whatsapp.net"
                      number:
                        type: string
                        example: "628123456789"
        400:
          description: Bad request
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"

  # GROUP MANAGEMENT
  /group/create:
    post:
      summary: Create a new WhatsApp group
      tags:
        - Groups
      security:
        - ApiKeyAuth: []
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required:
                - sessionId
                - name
                - participants
              properties:
                sessionId:
                  type: string
                  example: user1
                name:
                  type: string
                  example: "My Test Group"
                participants:
                  type: array
                  items:
                    type: string
                  example: ["628123456789", "628987654321"]
                description:
                  type: string
                  example: "This is a test group"
                delay:
                  type: integer
                  default: 1000
                  example: 1000
      responses:
        200:
          description: Group created successfully
          content:
            application/json:
              schema:
                allOf:
                  - $ref: "#/components/schemas/Status"
                  - type: object
                    properties:
                      message:
                        type: string
                        example: Group created successfully
                      groupInfo:
                        type: object
                      participants:
                        type: integer
                        example: 2
        400:
          description: Bad request
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"

  /group/add-participants:
    post:
      summary: Add participants to a group
      tags:
        - Groups
      security:
        - ApiKeyAuth: []
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required:
                - sessionId
                - groupId
                - participants
              properties:
                sessionId:
                  type: string
                  example: user1
                groupId:
                  type: string
                  example: "1234567890-group"
                participants:
                  type: array
                  items:
                    type: string
                  example: ["628123456789", "628987654321"]
                delay:
                  type: integer
                  default: 1000
                  example: 1000
      responses:
        200:
          description: Participants added successfully
          content:
            application/json:
              schema:
                allOf:
                  - $ref: "#/components/schemas/Status"
                  - type: object
                    properties:
                      message:
                        type: string
                        example: Participants added successfully
                      result:
                        type: array
                      added:
                        type: integer
                        example: 2
        400:
          description: Bad request
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"

  /group/remove-participants:
    post:
      summary: Remove participants from a group
      tags:
        - Groups
      security:
        - ApiKeyAuth: []
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required:
                - sessionId
                - groupId
                - participants
              properties:
                sessionId:
                  type: string
                  example: user1
                groupId:
                  type: string
                  example: "1234567890-group"
                participants:
                  type: array
                  items:
                    type: string
                  example: ["628123456789", "628987654321"]
                delay:
                  type: integer
                  default: 1000
                  example: 1000
      responses:
        200:
          description: Participants removed successfully
          content:
            application/json:
              schema:
                allOf:
                  - $ref: "#/components/schemas/Status"
                  - type: object
                    properties:
                      message:
                        type: string
                        example: Participants removed successfully
                      result:
                        type: array
                      removed:
                        type: integer
                        example: 2
        400:
          description: Bad request
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"

  /group/message:
    post:
      summary: Send a message to a group
      tags:
        - Groups
      security:
        - ApiKeyAuth: []
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required:
                - sessionId
                - groupId
                - message
              properties:
                sessionId:
                  type: string
                  example: user1
                groupId:
                  type: string
                  example: "1234567890-group"
                message:
                  type: string
                  example: "Hello everyone!"
                useQueue:
                  type: boolean
                  default: true
                  example: true
                queueOnly:
                  type: boolean
                  default: false
                  example: false
                delay:
                  type: integer
                  default: 1000
                  example: 1000
                retry:
                  type: integer
                  default: 3
                  example: 3
      responses:
        200:
          description: Group message sent successfully
          content:
            application/json:
              schema:
                allOf:
                  - $ref: "#/components/schemas/Status"
                  - type: object
                    properties:
                      message:
                        type: string
                        example: Group message sent successfully
                      messageInfo:
                        type: object
                      groupId:
                        type: string
                        example: "1234567890-group@g.us"
                      content:
                        type: string
                        example: "Hello everyone!"
        400:
          description: Bad request
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"

  /group/info/{sessionId}/{groupId}:
    get:
      summary: Get group information
      tags:
        - Groups
      security:
        - ApiKeyAuth: []
      parameters:
        - name: sessionId
          in: path
          required: true
          schema:
            type: string
        - name: groupId
          in: path
          required: true
          schema:
            type: string
      responses:
        200:
          description: Group information
          content:
            application/json:
              schema:
                allOf:
                  - $ref: "#/components/schemas/Status"
                  - type: object
                    properties:
                      group:
                        type: object
                        properties:
                          id:
                            type: string
                            example: "1234567890-group@g.us"
                          subject:
                            type: string
                            example: "My Test Group"
                          description:
                            type: string
                            example: "This is a test group"
                          owner:
                            type: string
                            example: "628123456789@s.whatsapp.net"
                          creation:
                            type: integer
                            example: 1680123456789
                          participants:
                            type: array
                            items:
                              type: object
                              properties:
                                id:
                                  type: string
                                  example: "628123456789@s.whatsapp.net"
                                isAdmin:
                                  type: boolean
                                  example: true
                          participantsCount:
                            type: integer
                            example: 3
        400:
          description: Bad request
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"

  # CALL HANDLING
  /call/settings:
    post:
      summary: Update call handling settings
      tags:
        - Calls
      security:
        - ApiKeyAuth: []
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required:
                - sessionId
              properties:
                sessionId:
                  type: string
                  example: user1
                rejectCalls:
                  type: boolean
                  default: true
                  example: true
                rejectVideoCalls:
                  type: boolean
                  default: true
                  example: true
                sendReplyMessage:
                  type: boolean
                  default: true
                  example: true
                audioCallReplyMessage:
                  type: string
                  example: "Sorry, I cannot take voice calls at the moment. Please send a message instead."
                videoCallReplyMessage:
                  type: string
                  example: "Sorry, I cannot take video calls at the moment. Please send a message instead."
                delay:
                  type: integer
                  default: 1000
                  example: 1000
      responses:
        200:
          description: Call settings updated successfully
          content:
            application/json:
              schema:
                allOf:
                  - $ref: "#/components/schemas/Status"
                  - type: object
                    properties:
                      message:
                        type: string
                        example: Call settings updated successfully
                      settings:
                        type: object
                        properties:
                          sessionId:
                            type: string
                            example: user1
                          rejectCalls:
                            type: boolean
                            example: true
                          rejectVideoCalls:
                            type: boolean
                            example: true
                          sendReplyMessage:
                            type: boolean
                            example: true
                          audioCallReplyMessage:
                            type: string
                            example: "Sorry, I cannot take voice calls at the moment. Please send a message instead."
                          videoCallReplyMessage:
                            type: string
                            example: "Sorry, I cannot take video calls at the moment. Please send a message instead."
                          delay:
                            type: integer
                            example: 1000
        400:
          description: Bad request
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"

  /call/status/{sessionId}:
    get:
      summary: Get call status
      tags:
        - Calls
      security:
        - ApiKeyAuth: []
      parameters:
        - name: sessionId
          in: path
          required: true
          schema:
            type: string
      responses:
        200:
          description: Call status
          content:
            application/json:
              schema:
                allOf:
                  - $ref: "#/components/schemas/Status"
                  - type: object
                    properties:
                      status:
                        type: object
                        properties:
                          sessionId:
                            type: string
                            example: user1
                          isCallActive:
                            type: boolean
                            example: true
                          isVideoCallActive:
                            type: boolean
                            example: false
                          isCallRejected:
                            type: boolean
                            example: false
                          isVideoCallRejected:
                            type: boolean
                            example: false
                          isCallAnswered:
                            type: boolean
                            example: false
                          isVideoCallAnswered:
                            type: boolean
                            example: false
                          isCallDeclined:
                            type: boolean
                            example: false
